## Прогноз оттока банковских клиентов


Из банка стали уходить клиенты. Каждый месяц. Немного, но заметно. Банковские маркетологи посчитали: сохранять текущих клиентов дешевле, чем привлекать новых. </br>
**Задача:** по имеющимся историческим данным о поведении клиентов построить модель, которая будет прогнозировать отток.</br>
</br>
Для изучения доступны 10.000 записей о банковском поведении клиентов обоих полов из Франции, Германии и Испании. Из банка ушли около 20% из них.</br>
</br>
**В числе признаков:**</br>
Категориальные: пол и страна.</br>
Количественные: кредитный рейтинг, продолжительность сотрудничества с банком, баланс счёта, число используемых продуктов банка и ожидаемая зарплата.</br>
Бинарные: наличие кредитной карты, является ли человек активным пользователем банка, ушел или не ушёл человек из банка (целевой признак).</br>
</br>
В ходе работы были отобраны наиболее важные признаки, проведено прямое кодирование категориальных признаков и масштабирование количественных признаков. Для заполнения пропусков использован KNNImputer. Для балансировки классов рассмотрены метод взвешивания, апсемплинга и даунсемплинга. </br>
</br>
**Были рассмотрены шесть моделей:** логистическая регрессия, дерево решений, случайный лес, метод К-ближайших соседей, метод оборных векторов, наивный байесовский классификатор. </br>
Лучшие результаты показали случайный лес и метод опорных векторов. Проведена настройка гиперпараметров для этих двух моделей. Достигнут требуемый порог F1 = 0.59, рассмотрена величина ROC-AUC. </br>
</br>
Проведена проверка на тестовой выборке, лучший результат на имеющихся данных получен при следующих параметрах: 
**Модель:** Random Forest Classifier</br>
**Параметры:** n_estimators=70, max_depth=11, random_state=17 </br>
**Обучение:** обучающая выборка с апсемплингом</br>
**Полученный результат на тестовой выборке:** F1 score: 0.62, ROC-AUC score: 0.86</br>
Проверка на адекватность проводилась сравнением с результатом случайной модели.
